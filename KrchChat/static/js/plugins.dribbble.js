!function(i){"use strict";i.jribbble={};function r(e,t){if(e&&"object"!=typeof e)return e;throw new Error(h.idRequired(t))}function s(e){var t={};return e.forEach(function(e){t[e]=function(r){return function(t){return this.queue.add(function(e){e.url+="/"+r+"/"+a(t||{})}),this}}.call(this,e)}.bind(this)),t}function u(e){var t,r;if(0!==e.length)return r={},"number"==(t=typeof(e=e[0]))||"string"==t?-1<l.indexOf(e)?r.list=e:r.resource=e:"object"==t&&(r=e),r}function c(){var e=i.extend({},i.Deferred());return e.queue=new function(){return this.methods=[],this.response=null,this.flushed=!1,this.add=function(e){this.flushed?e(this.scope):this.methods.push(e)},this.flush=function(e){if(!this.flushed){for(this.scope=e,this.flushed=!0;this.methods[0];)this.methods.shift()(e);return e}},this},e.url=o,e.get=function(){return t?(i.ajax({type:"GET",url:this.url,beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+t)},success:function(e){this.resolve(e)}.bind(this),error:function(e){this.reject(e)}.bind(this)}),this):(console.error(h.token),!1)},e}function n(r){return function(t){return i.extend(this,c()),this.queue.add(function(e){e.url+="/"+r+"/"+t}),setTimeout(function(){this.queue.flush(this).get()}.bind(this)),this}}var t=null,o="https://api.dribbble.com/v1",l=["animated","attachments","debuts","playoffs","rebounds","teams"],h={token:"Jribbble: Missing Dribbble access token. Set one with $.jribbble.accessToken = YOUR_ACCESS_TOKEN. If you do not have an access token, you must register a new application at https://dribbble.com/account/applications/new",singular:function(e){return e.substr(0,e.length-1)},idRequired:function(e){return"Jribbble: You have to provide a "+this.singular(e)+' ID. ex: $.jribbble.%@("1234").'.replace(/%@/g,e)},subResource:function(e){return"Jribbble: You have to provide a "+this.singular(e)+' ID to get %@. ex: $.jribbble.%@("1234").%@()'.replace(/%@/g,e)},shotId:function(e){return"Jribbble: You have to provide a shot ID to get %@. ex: "+' $.jribbble.shots("1234").%@()'.replace(/%@/g,e)},commentLikes:'Jribbble: You have to provide a comment ID to get likes. ex:  $.jribbble.shots("1234").comments("456").likes()'},a=function(e){e=i.param(e);return e?"?"+e:""};i.jribbble.shots=function(e,t){function r(n){return function(e,t){var r=u([].slice.call(arguments))||{},s=t||{};return this.queue.add(function(e){if(!e.shotId)throw new Error(h.shotId(n));e.url+="/"+n+"/",r.resource&&(e.url+=r.resource,delete r.resource),e.url+=a(i.extend(r,s))}),this}}function s(){return i.extend(this,c()),this.url+="/shots/",this.queue.add(function(e){n.resource&&(e.shotId=n.resource,e.url+=n.resource,delete n.resource),e.url+=a(i.extend(n,o))}),setTimeout(function(){this.queue.flush(this).get()}.bind(this)),this}var n=u([].slice.call(arguments))||{},o=t||{};return s.prototype.attachments=r("attachments"),s.prototype.buckets=r("buckets"),s.prototype.likes=r("likes"),s.prototype.projects=r("projects"),s.prototype.rebounds=r("rebounds"),s.prototype.comments=function(e,t){var r=u([].slice.call(arguments))||{},s=t||{};return this.queue.add(function(e){if(!e.shotId)throw new Error(h.shotId("comments"));e.url+="/comments/",r.resource&&(e.commentId=r.resource,e.url+=r.resource+"/",delete r.resource),e.url+=a(i.extend(r,s))}),this.likes=function(e){var t=e||{};return this.queue.add(function(e){if(!e.commentId)throw new Error(h.commentLikes);e.url+="likes/"+a(t)}),this},this},new s},i.jribbble.teams=function(e){var e=r(e,"teams"),t=n.call(this,"teams");return t.prototype=s.call(this,["members","shots"]),new t(e)},i.jribbble.users=function(e){var e=r(e,"users"),t=n.call(this,"users");return t.prototype=s.call(this,["buckets","followers","following","likes","projects","shots","teams"]),t.prototype.isFollowing=function(t){return this.queue.add(function(e){e.url+="/following/"+t}),this},new t(e)},i.jribbble.buckets=function(e){var t="buckets",e=r(e,t),t=n.call(this,t);return t.prototype=s.call(this,["shots"]),new t(e)},i.jribbble.projects=function(e){var t="projects",e=r(e,t),t=n.call(this,t);return t.prototype=s.call(this,["shots"]),new t(e)},i.jribbble.setToken=function(e){return t=e,this}}(jQuery,(window,document));